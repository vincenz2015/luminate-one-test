{"version":3,"sources":["webpack:///./frontend/scheduler/schedule.js","webpack:///./frontend/util/range.js","webpack:///./frontend/scheduler/ProjectOverview.vue?fbe8","webpack:///./frontend/scheduler/ProjectOverviewCell.js","webpack:///frontend/scheduler/ProjectOverview.vue","webpack:///./frontend/scheduler/ProjectOverview.vue?6b1c","webpack:///./frontend/scheduler/ProjectOverview.vue","webpack:///./frontend/auth/Logout.vue?49b0","webpack:///./frontend/auth/Logout.vue?1956","webpack:///frontend/auth/Logout.vue","webpack:///./frontend/auth/Logout.vue","webpack:///./frontend/scheduler/Timeline.js","webpack:///./plumbing/component.js","webpack:///./frontend/scheduler/TimeFilter.vue?669e","webpack:///./frontend/scheduler/TimeFilter.vue?1138","webpack:///frontend/scheduler/TimeFilter.vue","webpack:///./frontend/scheduler/TimeFilter.vue"],"names":["dayOffsetEpoch","spacetime","component","name","render","h","state","props","hub","scopedSlots","route","isdown","daysCount","limit","current","currenttime","visibleOffset","diff","calculateParams","e","offsetX","offsetY","day_offset","Math","min","max","floor","item_index","itemcount","day_index","day_indicies","range","class","editable","attrs","width","height","on","mousedown","target","currentTarget","button","params","emit","mousemove","buttons","mouseup","mouseleave","map","y","x","gap","cellSize","icon_x","icon_y","day_x","day_y","flat","lo","hi","res","i","push","project","projects","availabilityByProject","availability","count","pathie","visit","id","object","key","length","toString","_vm","this","_h","$createElement","_c","_self","staticClass","_v","resourcesHref","_l","p","projectHref","_s","icon","scheduled","remaining","create","backward","today","forward","_b","timelineprops","_u","fn","scheduleprops","logout","abbr","days","subtract","every","add","months","filter","d","index","date","format","day","query","Vue","extend","functional","ctx","hyperscript","parent","$store","$route","router","$router","data","$hub","directives","rawName","value","expression","domProps","$event","composing"],"mappings":"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","file":"4.js","sourcesContent":["import component from '../../plumbing/component'\r\nimport spacetime from 'spacetime'\r\nimport range from '../util/range'\r\nimport 'array-flat-polyfill'\r\n\r\nconst timezone = 'Pacific/Auckland'\r\n\r\n// gap around each cell\r\nconst gap = 3\r\n// width and height of each cell\r\nconst cellSize = 27\r\n// days are stored as an index offset from 2019-01-01\r\n// e.g. 0 is 2019-01-01\r\nconst dayOffsetEpoch = spacetime('2019-01-01', timezone)\r\n\r\nexport default component({\r\n    name: \"Schedule\",\r\n    render: (h, {state, props, hub, route, scopedSlots}) => {\r\n        const isdown = props.isdown !== null ? props.isdown : true\r\n        const daysCount = props.limit\r\n\r\n        const current = props.currenttime\r\n        const visibleOffset = dayOffsetEpoch.diff(current, 'days')\r\n        // given pixel coordinates map to item day coordinates\r\n        const calculateGrid = (offsetX, offsetY) => ({\r\n            day_offset:\r\n                Math.min(daysCount - 1,\r\n                    Math.max(0,\r\n                        Math.floor(offsetX / cellSize))),\r\n            item_index:\r\n                Math.min(props.itemcount - 1,\r\n                    Math.max(0,\r\n                        Math.floor((offsetY) / cellSize)))\r\n        })\r\n\r\n        const calculateParams = (e) => {\r\n            const { day_offset, item_index } = calculateGrid(e.offsetX, e.offsetY)\r\n            const day_index = day_offset + visibleOffset\r\n            const day_indicies = props.item_index == item_index\r\n                && props.day_index != day_index\r\n                ? range(props.day_index, day_index)\r\n                : [day_index]\r\n            return {\r\n                day_offset,\r\n                day_index,\r\n                item_index,\r\n                day_indicies\r\n            }\r\n        }\r\n\r\n        return h('svg.schedule', {\r\n            class: {\r\n                editable: props.editable\r\n            },\r\n            attrs: {\r\n                width: `${daysCount * cellSize}`,\r\n                height: `${props.itemcount * cellSize}`\r\n            },\r\n            on: props.editable\r\n            ? {\r\n                mousedown: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    if (e.button != 0) return\r\n                    const params = calculateParams(e)\r\n                    if (params.item_index == null) return\r\n                    hub.emit('mousedown', params)\r\n                },\r\n                mousemove: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    if (!isdown) return\r\n                    const params = calculateParams(e)\r\n                    if (e.buttons == 0)\r\n                        hub.emit('mouseup', params)\r\n                    else\r\n                        hub.emit('mousemove', params)\r\n                },\r\n                mouseup: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    const params = calculateParams(e)\r\n                    hub.emit('mouseup', params)\r\n                },\r\n                mouseleave: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    if (!isdown) return\r\n                    const params = calculateParams(e)\r\n                    hub.emit('mousemove', params)\r\n                }\r\n            }\r\n            : null\r\n        }, [\r\n\r\n            //Something in the params here is causing the issue\r\n            ...range(0, props.itemcount - 1).map((y) => range(0, daysCount - 1).map((x) => {\r\n                const params = {\r\n                    ...props,\r\n                    x, y, gap, cellSize,\r\n                    icon_x: 10.5 + gap + x * cellSize,\r\n                    icon_y: 17.5 + gap + y * cellSize,\r\n                    day_x: gap + x * cellSize,\r\n                    day_y: gap + y * cellSize,\r\n                    day_offset: x,\r\n                    day_index: x + visibleOffset,\r\n                    item_index: y\r\n                }\r\n                return [\r\n                    scopedSlots.default(params)\r\n                ]\r\n            })).flat()\r\n        ])\r\n    }\r\n})\r\n","// generate a range of integers between two numbers\r\n// inclusive of lo and hi\r\n// e.g. 1, 5 = [1, 2, 3, 4, 5]\r\n// will flip lo and hi if in the wrong order\r\nexport default (lo, hi) => {\r\n    if (lo > hi) [lo, hi] = [hi, lo]\r\n    const res = []\r\n    for (let i = lo; i <= hi; i++) res.push(i)\r\n    return res\r\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"attention\"},[_c('logout')],1),_vm._v(\" \"),_c('div',{staticClass:\"sidebyside\"},[_c('table',{staticClass:\"formal\"},[_c('thead',[_c('tr',[_c('th',{staticClass:\"d heading\"},[_c('router-link',{staticClass:\"transparent\",attrs:{\"to\":_vm.resourcesHref}},[_vm._v(\"Projects\")])],1),_vm._v(\" \"),_c('th',{staticClass:\"d\",attrs:{\"title\":\"Scheduled Days\"}},[_vm._v(\"Sch.\")]),_vm._v(\" \"),_c('th',{staticClass:\"d\",attrs:{\"title\":\"Remaining Days Unscheduled\"}},[_vm._v(\"Rem.\")])]),_vm._v(\" \"),_c('tr',{staticClass:\"schedule_actions\"},[_c('td',{attrs:{\"colspan\":\"3\"}},[_c('router-link',{staticClass:\"btn_nav\",attrs:{\"to\":_vm.resourcesHref}},[_vm._v(\"View schedule\")])],1)])]),_vm._v(\" \"),_c('tbody',_vm._l((_vm.projectSchedule),function(p){return _c('tr',{staticClass:\"table-row\"},[_c('td',{staticClass:\"d\"},[_c('router-link',{staticClass:\"transparent\",attrs:{\"to\":_vm.projectHref(p.project.id)}},[_vm._v(_vm._s(p.project.name)+\" \"),_c('span',{staticClass:\"icon\"},[_vm._v(_vm._s(p.project.icon))])])],1),_vm._v(\" \"),_c('td',{staticClass:\"d\"},[_vm._v(_vm._s(p.scheduled))]),_vm._v(\" \"),_c('td',{staticClass:\"d\"},[_vm._v(_vm._s(p.remaining))])])}),0),_vm._v(\" \"),_c('tfoot',[_c('tr',{staticClass:\"schedule_actions\"},[_c('td',[_c('button',{staticClass:\"btn_icon\",on:{\"click\":_vm.create}},[_vm._v(\"＋\")])])])])]),_vm._v(\" \"),_c('table',{staticClass:\"formal\"},[_c('thead',[_c('tr',[_c('th',{staticClass:\"heading\"},[_vm._v(\"Schedule\")]),_vm._v(\" \"),_c('td',{staticClass:\"heading_actions\"},[_c('time-filter'),_vm._v(\" \"),_c('button',{staticClass:\"btn_icon\",on:{\"click\":_vm.backward}},[_vm._v(\"<\")]),_vm._v(\" \"),_c('button',{staticClass:\"btn_icon\",on:{\"click\":_vm.today}},[_vm._v(\"T\")]),_vm._v(\" \"),_c('button',{staticClass:\"btn_icon\",on:{\"click\":_vm.forward}},[_vm._v(\">\")])],1)])]),_vm._v(\" \"),_c('tbody',[_c('tr',[_c('td',{attrs:{\"colspan\":\"2\"}},[_c('timeline',_vm._b({},'timeline',_vm.timelineprops,false)),_vm._v(\" \"),_c('schedule',_vm._b({scopedSlots:_vm._u([{key:\"default\",fn:function(params){return [_c('Cell',_vm._b({},'Cell',params,false))]}}])},'schedule',_vm.scheduleprops,false))],1)])])])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import component from '../../plumbing/component'\nimport pathie from 'pathie'\n\nexport default component({\n    name: 'ProjectOverviewCell',\n    render: (h, {state, props, hub, route}) => {\n        const project = state.project.projects[props.item_index]\n        if (!project) return [null]\n        const { availabilityByProject } = state.availability\n        const count = pathie.visit(availabilityByProject, [\n            props.day_index,\n            project.id\n        ], (object, key) => object[key] ? object[key].length : 0)\n\n        return [\n            count > 0\n            ? h('text.day', { attrs: { x: props.icon_x, y: props.icon_y } }, count.toString())\n            : null\n        ]\n    }\n})\n\n","<template>\r\n    <div>\r\n        <div class=\"attention\">\r\n            <logout></logout>\r\n        </div>\r\n        <div class=\"sidebyside\">\r\n            <table class=\"formal\">\r\n                <thead>\r\n                <tr>\r\n                    <th class=\"d heading\"><router-link :to=\"resourcesHref\" class=\"transparent\">Projects</router-link></th>\r\n                    <th class=\"d\" title=\"Scheduled Days\">Sch.</th>\r\n                    <th class=\"d\" title=\"Remaining Days Unscheduled\">Rem.</th>\r\n                </tr>\r\n                <tr class=\"schedule_actions\">\r\n                    <td colspan=\"3\">\r\n                        <router-link :to=\"resourcesHref\" class=\"btn_nav\">View schedule</router-link>\r\n                    </td>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr v-for=\"p in projectSchedule\" class=\"table-row\">\r\n                    <td class=\"d\"><router-link :to=\"projectHref(p.project.id)\" class=\"transparent\">{{ p.project.name }} <span class=\"icon\">{{ p.project.icon }}</span></router-link></td>\r\n                    <td class=\"d\">{{ p.scheduled }}</td>\r\n                    <td class=\"d\">{{ p.remaining }}</td>\r\n                </tr>\r\n                </tbody>\r\n                <tfoot>\r\n                <tr class=\"schedule_actions\">\r\n                    <td>\r\n                        <button @click=\"create\" class=\"btn_icon\">＋</button>\r\n                    </td>\r\n                </tr>\r\n                </tfoot>\r\n            </table>\r\n\r\n            <table class=\"formal\">\r\n                <thead>\r\n                <tr>\r\n                    <th class=\"heading\">Schedule</th>\r\n                    <td class=\"heading_actions\">\r\n                        <time-filter></time-filter>\r\n                        <button @click=\"backward\" class=\"btn_icon\"><</button>\r\n                        <button @click=\"today\" class=\"btn_icon\">T</button>\r\n                        <button @click=\"forward\" class=\"btn_icon\">></button>\r\n                    </td>\r\n                </tr>\r\n                </thead>\r\n                <tbody>\r\n                <tr>\r\n                    <td colspan=\"2\">\r\n                        <timeline v-bind=\"timelineprops\"></timeline>\r\n                        <schedule v-bind=\"scheduleprops\" v-slot=\"params\">\r\n                            <Cell v-bind=\"params\"></Cell>\r\n                        </schedule>\r\n                    </td>\r\n                </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import spacetime from 'spacetime'\r\n    import Schedule from './schedule'\r\n    import Cell from './ProjectOverviewCell'\r\n    import Timeline from './Timeline'\r\n    import TimeFilter from './TimeFilter'\r\n    import pathie from 'pathie'\r\n    import logout from '../auth/Logout'\r\n\r\n    const timezone = 'Pacific/Auckland'\r\n    const dayOffsetEpoch = spacetime('2019-01-01', timezone)\r\n    const daysCount = 7*13\r\n\r\n    export default {\r\n        components: {\r\n            Schedule,\r\n            Timeline,\r\n            Cell,\r\n            TimeFilter,\r\n            logout\r\n        },\r\n        data() {\r\n            return {\r\n                currenttime: spacetime.today(timezone),\r\n                days: 31\r\n            }\r\n        },\r\n        mounted() {\r\n            this.days = this.$store.state.timefilter.days;\r\n            this.$on('update days', (days) => {\r\n                this.days = days;\r\n            })\r\n        },\r\n        beforeCreate() {\r\n            Promise.all([\r\n                this.$hub.emit('load resources'),\r\n                this.$hub.emit('load projects')\r\n            ])\r\n            .then(() => this.$hub.emit('load availability'))\r\n            .then(() => this.$hub.emit('update'))\r\n        },\r\n        computed: {\r\n            availabilityByProject() {\r\n                return this.$store.state.availability.availabilityByProject\r\n            },\r\n            projects() {\r\n                return this.$store.state.project.projects\r\n            },\r\n            projectSchedule() {\r\n                const result = {}\r\n                const visibleOffset = dayOffsetEpoch.diff(this.currenttime, 'days')\r\n                for (const project of this.projects)\r\n                    result[project.id] = {\r\n                        project,\r\n                        remaining: project.estimate,\r\n                        scheduled: 0\r\n                    }\r\n                for (const a of pathie.flat(this.availabilityByProject, 2)) {\r\n                    if (a[0] < visibleOffset) continue\r\n                    if (a[0] >= visibleOffset + daysCount) continue\r\n                    result[a[1]].remaining -= a[2].length\r\n                    result[a[1]].scheduled += a[2].length\r\n                }\r\n                return result\r\n            },\r\n            timelineprops() {\r\n                return {\r\n                    editable: false,\r\n                    currenttime: this.currenttime,\r\n                    limit: this.days,\r\n                    ...this.$attrs\r\n                }\r\n            },\r\n            scheduleprops() {\r\n                return {\r\n                    editable: false,\r\n                    itemcount: this.$store.state.project.projects.length,\r\n                    currenttime: this.currenttime,\r\n                    limit: this.days,\r\n                    ...this.$attrs\r\n                }\r\n            },\r\n            resourcesHref() {\r\n                return '/'\r\n            }\r\n        },\r\n        methods: {\r\n            create() {\r\n                this.$router.push('/project/create')\r\n            },\r\n            projectHref(id) {\r\n                return `/project/${id}`\r\n            },\r\n            update(project) {\r\n                hub.emit('update project', project)\r\n            },\r\n            remove(id) {\r\n                hub.emit('delete project', r.id)\r\n            },\r\n            backward() {\r\n                this.currenttime = this.currenttime.subtract(1, 'week')\r\n            },\r\n            forward() {\r\n                this.currenttime = this.currenttime.add(1, 'week')\r\n            },\r\n            today() {\r\n                this.currenttime = spacetime.now()\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--4-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProjectOverview.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--4-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ProjectOverview.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ProjectOverview.vue?vue&type=template&id=6ed7a3f0&\"\nimport script from \"./ProjectOverview.vue?vue&type=script&lang=js&\"\nexport * from \"./ProjectOverview.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('button',{staticClass:\"btn_submit btn_logout\",on:{\"click\":_vm.logout}},[_vm._v(\"Logout\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--4-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logout.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--4-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Logout.vue?vue&type=script&lang=js&\"","<template>\r\n    <button @click=\"logout\" class=\"btn_submit btn_logout\">Logout</button>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: 'logout',\r\n        methods: {\r\n            logout() {\r\n                this.$hub.emit('logout');\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","import { render, staticRenderFns } from \"./Logout.vue?vue&type=template&id=01abc130&\"\nimport script from \"./Logout.vue?vue&type=script&lang=js&\"\nexport * from \"./Logout.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import component from '../../plumbing/component'\r\nimport spacetime from 'spacetime'\r\nimport range from '../util/range'\r\nimport 'array-flat-polyfill'\r\n\r\nconst timezone = 'Pacific/Auckland'\r\n// Convert day of week to first letter\r\nconst abbr = ['S', 'M', 'T', 'W', 'T', 'F', 'S']\r\n// how many days to display at once\r\nconst daysCount = 7*13\r\n\r\n// gap around each cell\r\nconst gap = 3\r\n// space above cells for month, day of month and day of week\r\nconst actionsOffset = 73\r\n// width and height of each cell\r\nconst cellSize = 27\r\n// days are stored as an index offset from 2019-01-01\r\n// e.g. 0 is 2019-01-01\r\nconst dayOffsetEpoch = spacetime('2019-01-01', timezone)\r\n\r\nexport default component({\r\n    name: \"Timeline\",\r\n    render: (h, {state, props, hub, route}) => {\r\n        const isdown = props.isdown !== null ? props.isdown : true\r\n\r\n        const current = props.currenttime\r\n        const visibleOffset = dayOffsetEpoch.diff(current, 'days')\r\n        const days = current.subtract(1, 'day')\r\n            .every('day', current.add(props.limit, 'days'))\r\n        const calculateOffset = (offsetX) =>\r\n            Math.min(daysCount - 1,\r\n                Math.max(0,\r\n                    Math.floor(offsetX / cellSize)))\r\n\r\n        const calculateParams = (e) => {\r\n            const day_offset = calculateOffset(e.offsetX)\r\n            const day_index = day_offset + visibleOffset\r\n            const day_indicies = props.day_index != day_index\r\n                ? range(props.day_index, day_index)\r\n                : [day_index]\r\n            return {\r\n                day_offset,\r\n                day_index,\r\n                day_indicies\r\n            }\r\n        }\r\n\r\n        // get all months\r\n        let months = days.filter((d, i) => {\r\n            d.index = i;\r\n            return d.date() == 1;\r\n        });\r\n\r\n        return h('svg.timeline', {\r\n            class: {\r\n                editable: props.editable\r\n            },\r\n            attrs: {\r\n                width: `${daysCount * cellSize}`,\r\n                height: `${actionsOffset}`\r\n            },\r\n            on: props.editable\r\n            ? {\r\n                mousedown: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    if (e.button != 0) return\r\n                    const params = calculateParams(e)\r\n                    hub.emit('mousedown', params)\r\n                },\r\n                mousemove: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    if (!isdown) return\r\n                    const params = calculateParams(e)\r\n                    if (e.buttons == 0)\r\n                        hub.emit('mouseup', params)\r\n                    else\r\n                        hub.emit('mousemove', params)\r\n                },\r\n                mouseup: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    const params = calculateParams(e)\r\n                    hub.emit('mouseup', params)\r\n                },\r\n                mouseleave: (e) => {\r\n                    if (e.target !== e.currentTarget) return\r\n                    if (!isdown) return\r\n                    const params = calculateParams(e)\r\n                    hub.emit('mousemove', params)\r\n                }\r\n            }\r\n            : null\r\n        }, [\r\n            ...months.map((d) => {\r\n                return h('text.month',\r\n                    {\r\n                        attrs: {\r\n                            x: 10 + d.index * cellSize,\r\n                            y: 24\r\n                        }\r\n                    }, days[d.index].format('{month} {year}')\r\n                )\r\n            }),\r\n            ...days.map((d, x) =>\r\n                h('text.day',\r\n                    {\r\n                        attrs: {\r\n                            x: 13.5 + x * cellSize,\r\n                            y: 43\r\n                        }\r\n                    }, d.date()\r\n                )),\r\n            ...days.map((d, x) =>\r\n                h('text.day',\r\n                    {\r\n                        attrs: {\r\n                            x: 13.5 + x * cellSize,\r\n                            y: 60\r\n                        }\r\n                    }, abbr[d.day()]\r\n                ))\r\n        ])\r\n    }\r\n})\r\n","import Vue from 'vue'\r\nimport hyperscript from 'vue-hyperscript-terse'\r\n\r\n// https://vuejs.org/v2/guide/render-function.html\r\nexport default ({query, name, render}) => Vue.extend({\r\n    name: name,\r\n    functional: true,\r\n    query: query,\r\n    render: (h, ctx) => {\r\n        return render(hyperscript(h), {\r\n            state: ctx.parent.$store.state,\r\n            route: ctx.parent.$route,\r\n            router: ctx.parent.$router,\r\n            hub: ctx.props.hub || ctx.data.hub || ctx.parent.$hub,\r\n            ...ctx\r\n        })\r\n    }\r\n})\r\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"timeline-filter\"},[_c('h4',[_vm._v(\"Showing \"),_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.days),expression:\"days\"}],attrs:{\"type\":\"number\",\"min\":\"7\",\"max\":\"365\"},domProps:{\"value\":(_vm.days)},on:{\"change\":_vm.emit,\"input\":function($event){if($event.target.composing){ return; }_vm.days=$event.target.value}}}),_vm._v(\" days\")])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../node_modules/babel-loader/lib/index.js??ref--4-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimeFilter.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/babel-loader/lib/index.js??ref--4-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TimeFilter.vue?vue&type=script&lang=js&\"","<template>\r\n    <div class=\"timeline-filter\">\r\n        <h4>Showing <input v-model=\"days\" @change=\"emit\" type=\"number\" min=\"7\" max=\"365\"> days</h4>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                days: -1\r\n            }\r\n        },\r\n        mounted() {\r\n            this.days = this.$store.state.timefilter.days;\r\n\r\n            if(this.days === -1){\r\n                let leftWidth = document.getElementsByClassName('formal')[0].offsetWidth;\r\n                let rightWidth = window.innerWidth - leftWidth;\r\n                this.days = Math.round(rightWidth / (26 + 3));\r\n                this.emit();\r\n            }\r\n        },\r\n        methods: {\r\n            emit() {\r\n                this.$hub.emit('update days', this.days);\r\n                this.$parent.$emit('update days', this.days);\r\n            }\r\n        }\r\n    }\r\n</script>\r\n","import { render, staticRenderFns } from \"./TimeFilter.vue?vue&type=template&id=f3c51ac4&\"\nimport script from \"./TimeFilter.vue?vue&type=script&lang=js&\"\nexport * from \"./TimeFilter.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}